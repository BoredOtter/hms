apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../../base
- ingress.yaml
- configmaps.yaml

images:
  - name: client
    newName: ksw2137/hms-client
    newTag: __TAG__
  - name: kraken
    newName: ksw2137/hms-kraken
    newTag: __TAG__
  - name: validator
    newName: ksw2137/hms-validator
    newTag: __TAG__
  - name: patients
    newName: ksw2137/hms-patients
    newTag: __TAG__

patches:
- target:
    group: apps
    version: v1
    kind: Deployment
    name: keycloak
  path: keycloak-patch.yaml

configMapGenerator:
- name: client
  literals:
  - KEYCLOAK_SERVER_URL=https://auth.hms.test.boredotter.dev
  - REALM_NAME=hms
  - CLIENT_ID=hms-client

# In dev env idk about creds in repo
secretGenerator:
- name: kc-client-config
  literals:
  - KC_CLIENT_ID="python"
  - KC_CLIENT_SECRET="olszak-sie-obrazi-jak-wpisze-tu-cos-smiesznego"
- name: validator
  literals:
  - KC_CLIENT_ID="python"
  - KC_CLIENT_SECRET="olszak-sie-obrazi-jak-wpisze-tu-cos-smiesznego"

- name: postgres-credentials-keycloak
  literals:
  - POSTGRES_USER=keycloak
  - POSTGRES_PASSWORD=keycloak
  - POSTGRES_DB=keycloak



- name: keycloak-credentials
  literals:
  - KEYCLOAK_ADMIN=boredadmin
  - KEYCLOAK_ADMIN_PASSWORD=boredadmin